#!/bin/sh

# UQCS testing slack tokens
token_0=xoxb-260143289456-hIuFgNWfXnYppxDIfcQLPVU1 
token_1=xoxb-260850095972-tLzDIfVLiy89sbPVJacom5M3 
token_2=xoxb-260936998101-XKDFqzvhGRCcDHCAhemVTH27 
token_3=xoxb-261681938550-SWmDKXm8iv9ozWzgUiWCTCmJ

set -e

export PATH="node_modules/.bin:node_modules/hubot/node_modules/.bin:$PATH"

if [ $# -eq 3 ] && [ "$1" = "--adapter" ] && [ "$2" = "slack" ]; then
    index=$3
    if [ $index -gt 3 ] || [ $index -lt 0 ]; then
        echo "Slack token selection must be in the range of 0-3"
    else
        if [ $index -eq 0 ]; then
            export HUBOT_SLACK_TOKEN=$token_0
        fi
        if [ $index -eq 1 ]; then
            export HUBOT_SLACK_TOKEN=$token_1
        fi
        if [ $index -eq 2 ]; then
            export HUBOT_SLACK_TOKEN=$token_2
        fi
        if [ $index -eq 3 ]; then
            export HUBOT_SLACK_TOKEN=$token_3
        fi

        exec node_modules/.bin/hubot --name "uqcsbot" --alias "!" $1 $2
    fi
else
    exec node_modules/.bin/hubot --name "uqcsbot" --alias "!" "$@"
fi
